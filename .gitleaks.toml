# Gitleaks configuration for DelTran
# https://github.com/gitleaks/gitleaks

title = "DelTran Secrets Detection"

[extend]
useDefault = true

[[rules]]
id = "aws-access-key-id"
description = "AWS Access Key ID"
regex = '''(?i)(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}'''
tags = ["aws", "credentials"]
[rules.allowlist]
paths = [
    '''.*_test\.go''',
    '''.*_test\.rs''',
    '''.*\.example$''',
]

[[rules]]
id = "aws-secret-access-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws(.{0,20})?['\"][0-9a-zA-Z\/+]{40}['\"]'''
tags = ["aws", "credentials"]

[[rules]]
id = "private-key"
description = "Private Key (RSA, DSA, EC, PGP)"
regex = '''-----BEGIN (RSA|DSA|EC|PGP|OPENSSH) PRIVATE KEY-----'''
tags = ["key", "private"]
[rules.allowlist]
paths = [
    '''test/fixtures/.*''',
    '''docs/examples/.*''',
]

[[rules]]
id = "api-key-generic"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|apikey)(.{0,20})?['\"][0-9a-zA-Z]{32,}['\"]'''
tags = ["api", "key"]
[rules.allowlist]
paths = [
    '''.*\.example$''',
    '''.*\.md$''',
]

[[rules]]
id = "jwt-token"
description = "JWT Token"
regex = '''eyJ[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}'''
tags = ["jwt", "token"]
[rules.allowlist]
paths = [
    '''.*_test\..*''',
    '''docs/.*''',
]

[[rules]]
id = "database-connection-string"
description = "Database Connection String"
regex = '''(?i)(postgres|mysql|mongodb)://[a-zA-Z0-9_-]+:[a-zA-Z0-9_-]+@'''
tags = ["database", "credentials"]
[rules.allowlist]
paths = [
    '''.*\.example$''',
    '''docker-compose.*\.yml$''',
]

[[rules]]
id = "slack-token"
description = "Slack Token"
regex = '''xox[baprs]-[0-9]{10,13}-[0-9]{10,13}-[a-zA-Z0-9]{24,}'''
tags = ["slack", "token"]

[[rules]]
id = "github-pat"
description = "GitHub Personal Access Token"
regex = '''ghp_[0-9a-zA-Z]{36}'''
tags = ["github", "token"]

[[rules]]
id = "nats-credentials"
description = "NATS Credentials"
regex = '''-----BEGIN NATS USER JWT-----'''
tags = ["nats", "credentials"]

[[rules]]
id = "hsm-pin"
description = "HSM PIN or Key"
regex = '''(?i)(hsm[_-]?pin|hsm[_-]?key)(.{0,20})?['\"][0-9]{4,}['\"]'''
tags = ["hsm", "pin"]

[[rules]]
id = "bank-api-key"
description = "Bank API Key"
regex = '''(?i)(swift[_-]?api|bank[_-]?api)(.{0,20})?['\"][0-9a-zA-Z]{20,}['\"]'''
tags = ["bank", "api"]

[allowlist]
description = "Global allowlist"
paths = [
    '''\.git/.*''',
    '''target/.*''',
    '''node_modules/.*''',
    '''.*\.lock$''',
    '''.*\.min\.js$''',
    '''.*\.map$''',
    '''CHANGELOG\.md$''',
]
commits = []
regexes = [
    # Placeholder values
    '''(EXAMPLE|PLACEHOLDER|TODO|FIXME|XXX)''',
    # Test fixtures
    '''test[_-]?(key|token|secret)''',
]
