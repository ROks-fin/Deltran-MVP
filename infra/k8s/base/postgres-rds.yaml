# PostgreSQL on AWS RDS (Multi-AZ)
# This is a placeholder for external RDS configuration
# Actual RDS is provisioned via Terraform/CloudFormation

apiVersion: v1
kind: Service
metadata:
  name: postgres
  namespace: deltran
  labels:
    app: postgres
spec:
  type: ExternalName
  externalName: deltran-prod.cluster-xxxxx.us-east-1.rds.amazonaws.com
  ports:
  - name: postgres
    port: 5432
    targetPort: 5432
---
apiVersion: v1
kind: Secret
metadata:
  name: deltran-secrets
  namespace: deltran
type: Opaque
stringData:
  # These should be populated from AWS Secrets Manager or external secret operator
  database-url: "postgresql://deltran:CHANGE_ME@postgres:5432/deltran?sslmode=require"
  redis-password: "CHANGE_ME"
  nats-password: "CHANGE_ME"
  nats-sys-password: "CHANGE_ME"
  jwt-secret: "CHANGE_ME"
---
# Example database connection config for applications
apiVersion: v1
kind: ConfigMap
metadata:
  name: database-config
  namespace: deltran
data:
  postgres-host: "deltran-prod.cluster-xxxxx.us-east-1.rds.amazonaws.com"
  postgres-port: "5432"
  postgres-db: "deltran"
  postgres-sslmode: "require"
  # Connection pool settings
  max-connections: "100"
  min-connections: "10"
  connection-timeout: "30"
  idle-timeout: "600"
